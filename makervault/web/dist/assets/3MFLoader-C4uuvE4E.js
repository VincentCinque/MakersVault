import{L as Pe,F as Ve,e as Je,G as Me,C as Qe,f as Ye,g as Ze,B as ve,c as Ie,h as be,i as ye,d as le,j as xe,k as qe,l as Le,m as we,n as Ue,N as Be,o as _e}from"./index-B8ZH1zH1.js";/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.6.9
*/var ze=function(r){return URL.createObjectURL(new Blob([r],{type:"text/javascript"}))};try{URL.revokeObjectURL(ze(""))}catch{ze=function(n){return"data:application/javascript;charset=UTF-8,"+encodeURI(n)}}var I=Uint8Array,V=Uint16Array,Re=Uint32Array,Ge=new I([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),He=new I([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),et=new I([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$e=function(r,n){for(var c=new V(31),f=0;f<31;++f)c[f]=n+=1<<r[f-1];for(var d=new Re(c[30]),f=1;f<30;++f)for(var y=c[f];y<c[f+1];++y)d[y]=y-c[f]<<5|f;return[c,d]},We=$e(Ge,2),Xe=We[0],tt=We[1];Xe[28]=258,tt[258]=28;var rt=$e(He,0),nt=rt[0],je=new V(32768);for(var S=0;S<32768;++S){var K=(S&43690)>>>1|(S&21845)<<1;K=(K&52428)>>>2|(K&13107)<<2,K=(K&61680)>>>4|(K&3855)<<4,je[S]=((K&65280)>>>8|(K&255)<<8)>>>1}var ce=function(r,n,c){for(var f=r.length,d=0,y=new V(n);d<f;++d)++y[r[d]-1];var M=new V(n);for(d=0;d<n;++d)M[d]=M[d-1]+y[d-1]<<1;var k;if(c){k=new V(1<<n);var v=15-n;for(d=0;d<f;++d)if(r[d])for(var x=d<<4|r[d],D=n-r[d],j=M[r[d]-1]++<<D,q=j|(1<<D)-1;j<=q;++j)k[je[j]>>>v]=x}else for(k=new V(f),d=0;d<f;++d)r[d]&&(k[d]=je[M[r[d]-1]++]>>>15-r[d]);return k},ue=new I(288);for(var S=0;S<144;++S)ue[S]=8;for(var S=144;S<256;++S)ue[S]=9;for(var S=256;S<280;++S)ue[S]=7;for(var S=280;S<288;++S)ue[S]=8;var Ke=new I(32);for(var S=0;S<32;++S)Ke[S]=5;var ot=ce(ue,9,1),st=ce(Ke,5,1),ke=function(r){for(var n=r[0],c=1;c<r.length;++c)r[c]>n&&(n=r[c]);return n},L=function(r,n,c){var f=n/8|0;return(r[f]|r[f+1]<<8)>>(n&7)&c},Ce=function(r,n){var c=n/8|0;return(r[c]|r[c+1]<<8|r[c+2]<<16)>>(n&7)},it=function(r){return(r/8|0)+(r&7&&1)},Ee=function(r,n,c){(n==null||n<0)&&(n=0),(c==null||c>r.length)&&(c=r.length);var f=new(r instanceof V?V:r instanceof Re?Re:I)(c-n);return f.set(r.subarray(n,c)),f},at=function(r,n,c){var f=r.length;if(!f||c&&!c.l&&f<5)return n||new I(0);var d=!n||c,y=!c||c.i;c||(c={}),n||(n=new I(f*3));var M=function(s){var a=n.length;if(s>a){var l=new I(Math.max(a*2,s));l.set(n),n=l}},k=c.f||0,v=c.p||0,x=c.b||0,D=c.l,j=c.d,q=c.m,H=c.n,B=f*8;do{if(!D){c.f=k=L(r,v,1);var ee=L(r,v+1,3);if(v+=3,ee)if(ee==1)D=ot,j=st,q=9,H=5;else if(ee==2){var ne=L(r,v,31)+257,pe=L(r,v+10,15)+4,fe=ne+L(r,v+5,31)+1;v+=14;for(var J=new I(fe),oe=new I(19),N=0;N<pe;++N)oe[et[N]]=L(r,v+N*3,7);v+=pe*3;for(var de=ke(oe),Ae=(1<<de)-1,Fe=ce(oe,de,1),N=0;N<fe;){var he=Fe[L(r,v,Ae)];v+=he&15;var E=he>>>4;if(E<16)J[N++]=E;else{var $=0,Z=0;for(E==16?(Z=3+L(r,v,3),v+=2,$=J[N-1]):E==17?(Z=3+L(r,v,7),v+=3):E==18&&(Z=11+L(r,v,127),v+=7);Z--;)J[N++]=$}}var Q=J.subarray(0,ne),z=J.subarray(ne);q=ke(Q),H=ke(z),D=ce(Q,q,1),j=ce(z,H,1)}else throw"invalid block type";else{var E=it(v)+4,te=r[E-4]|r[E-3]<<8,re=E+te;if(re>f){if(y)throw"unexpected EOF";break}d&&M(x+te),n.set(r.subarray(E,re),x),c.b=x+=te,c.p=v=re*8;continue}if(v>B){if(y)throw"unexpected EOF";break}}d&&M(x+131072);for(var Se=(1<<q)-1,me=(1<<H)-1,se=v;;se=v){var $=D[Ce(r,v)&Se],W=$>>>4;if(v+=$&15,v>B){if(y)throw"unexpected EOF";break}if(!$)throw"invalid length/literal";if(W<256)n[x++]=W;else if(W==256){se=v,D=null;break}else{var ge=W-254;if(W>264){var N=W-257,X=Ge[N];ge=L(r,v,(1<<X)-1)+Xe[N],v+=X}var ie=j[Ce(r,v)&me],t=ie>>>4;if(!ie)throw"invalid distance";v+=ie&15;var z=nt[t];if(t>3){var X=He[t];z+=Ce(r,v)&(1<<X)-1,v+=X}if(v>B){if(y)throw"unexpected EOF";break}d&&M(x+131072);for(var e=x+ge;x<e;x+=4)n[x]=n[x-z],n[x+1]=n[x+1-z],n[x+2]=n[x+2-z],n[x+3]=n[x+3-z];x=e}}c.l=D,c.p=se,c.b=x,D&&(k=1,c.m=q,c.d=j,c.n=H)}while(!k);return x==n.length?n:Ee(n,0,x)},lt=new I(0),G=function(r,n){return r[n]|r[n+1]<<8},U=function(r,n){return(r[n]|r[n+1]<<8|r[n+2]<<16|r[n+3]<<24)>>>0},Te=function(r,n){return U(r,n)+U(r,n+4)*4294967296};function ct(r,n){return at(r,n)}var Ne=typeof TextDecoder<"u"&&new TextDecoder,ut=0;try{Ne.decode(lt,{stream:!0}),ut=1}catch{}var pt=function(r){for(var n="",c=0;;){var f=r[c++],d=(f>127)+(f>223)+(f>239);if(c+d>r.length)return[n,Ee(r,c-1)];d?d==3?(f=((f&15)<<18|(r[c++]&63)<<12|(r[c++]&63)<<6|r[c++]&63)-65536,n+=String.fromCharCode(55296|f>>10,56320|f&1023)):d&1?n+=String.fromCharCode((f&31)<<6|r[c++]&63):n+=String.fromCharCode((f&15)<<12|(r[c++]&63)<<6|r[c++]&63):n+=String.fromCharCode(f)}};function ft(r,n){if(n){for(var c="",f=0;f<r.length;f+=16384)c+=String.fromCharCode.apply(null,r.subarray(f,f+16384));return c}else{if(Ne)return Ne.decode(r);var d=pt(r),y=d[0],M=d[1];if(M.length)throw"invalid utf-8 data";return y}}var dt=function(r,n){return n+30+G(r,n+26)+G(r,n+28)},ht=function(r,n,c){var f=G(r,n+28),d=ft(r.subarray(n+46,n+46+f),!(G(r,n+8)&2048)),y=n+46+f,M=U(r,n+20),k=c&&M==4294967295?mt(r,y):[M,U(r,n+24),U(r,n+42)],v=k[0],x=k[1],D=k[2];return[G(r,n+10),v,x,d,y+G(r,n+30)+G(r,n+32),D]},mt=function(r,n){for(;G(r,n)!=1;n+=4+G(r,n+2));return[Te(r,n+12),Te(r,n+4),Te(r,n+20)]};function gt(r){for(var n={},c=r.length-22;U(r,c)!=101010256;--c)if(!c||r.length-c>65558)throw"invalid zip file";var f=G(r,c+8);if(!f)return{};var d=U(r,c+16),y=d==4294967295;if(y){if(c=U(r,c-12),U(r,c)!=101075792)throw"invalid zip file";f=U(r,c+32),d=U(r,c+48)}for(var M=0;M<f;++M){var k=ht(r,d,y),v=k[0],x=k[1],D=k[2],j=k[3],q=k[4],H=k[5],B=dt(r,H);if(d=q,!v)n[j]=Ee(r,B,B+x);else if(v==8)n[j]=ct(r.subarray(B,B+x),new I(D));else throw"unknown compression type "+v}return n}const De=Ye;class bt extends Pe{constructor(n){super(n),this.availableExtensions=[]}load(n,c,f,d){const y=this,M=new Ve(y.manager);M.setPath(y.path),M.setResponseType("arraybuffer"),M.setRequestHeader(y.requestHeader),M.setWithCredentials(y.withCredentials),M.load(n,function(k){try{c(y.parse(k))}catch(v){d?d(v):console.error(v),y.manager.itemError(n)}},f,d)}parse(n){const c=this,f=new Je(this.manager);function d(t){let e=null,s=null,a,l;const i=[],u=[];let p;const o={},h={},m={},g=new TextDecoder;try{e=gt(new Uint8Array(t))}catch(A){if(A instanceof ReferenceError)return console.error("THREE.3MFLoader: fflate missing and file is compressed."),null}for(s in e)s.match(/\_rels\/.rels$/)?a=s:s.match(/3D\/_rels\/.*\.model\.rels$/)?l=s:s.match(/^3D\/.*\.model$/)?i.push(s):s.match(/^3D\/Textures?\/.*/)&&u.push(s);const O=e[a],F=g.decode(O),C=y(F);if(l){const A=e[l],b=g.decode(A);p=y(b)}for(let A=0;A<i.length;A++){const b=i[A],w=e[b],T=g.decode(w),R=new DOMParser().parseFromString(T,"application/xml");R.documentElement.nodeName.toLowerCase()!=="model"&&console.error("THREE.3MFLoader: Error loading 3MF - no 3MF document found: ",b);const _=R.querySelector("model"),Y={};for(let P=0;P<_.attributes.length;P++){const Oe=_.attributes[P];Oe.name.match(/^xmlns:(.+)$/)&&(Y[Oe.value]=RegExp.$1)}const ae=pe(_);ae.xml=_,0<Object.keys(Y).length&&(ae.extensions=Y),o[b]=ae}for(let A=0;A<u.length;A++){const b=u[A];m[b]=e[b].buffer}return{rels:C,modelRels:p,model:o,printTicket:h,texture:m}}function y(t){const e=[],a=new DOMParser().parseFromString(t,"application/xml").querySelectorAll("Relationship");for(let l=0;l<a.length;l++){const i=a[l],u={target:i.getAttribute("Target"),id:i.getAttribute("Id"),type:i.getAttribute("Type")};e.push(u)}return e}function M(t){const e={};for(let s=0;s<t.length;s++){const a=t[s],l=a.getAttribute("name");0<=["Title","Designer","Description","Copyright","LicenseTerms","Rating","CreationDate","ModificationDate"].indexOf(l)&&(e[l]=a.textContent)}return e}function k(t){const e={id:t.getAttribute("id"),basematerials:[]},s=t.querySelectorAll("base");for(let a=0;a<s.length;a++){const l=s[a],i=q(l);i.index=a,e.basematerials.push(i)}return e}function v(t){return{id:t.getAttribute("id"),path:t.getAttribute("path"),contenttype:t.getAttribute("contenttype"),tilestyleu:t.getAttribute("tilestyleu"),tilestylev:t.getAttribute("tilestylev"),filter:t.getAttribute("filter")}}function x(t){const e={id:t.getAttribute("id"),texid:t.getAttribute("texid"),displaypropertiesid:t.getAttribute("displaypropertiesid")},s=t.querySelectorAll("tex2coord"),a=[];for(let l=0;l<s.length;l++){const i=s[l],u=i.getAttribute("u"),p=i.getAttribute("v");a.push(parseFloat(u),parseFloat(p))}return e.uvs=new Float32Array(a),e}function D(t){const e={id:t.getAttribute("id"),displaypropertiesid:t.getAttribute("displaypropertiesid")},s=t.querySelectorAll("color"),a=[],l=new Qe;for(let i=0;i<s.length;i++){const p=s[i].getAttribute("color");l.setStyle(p.substring(0,7),De),a.push(l.r,l.g,l.b)}return e.colors=new Float32Array(a),e}function j(t){const e={id:t.getAttribute("id")},s=t.querySelectorAll("pbmetallic"),a=[];for(let l=0;l<s.length;l++){const i=s[l];a.push({name:i.getAttribute("name"),metallicness:parseFloat(i.getAttribute("metallicness")),roughness:parseFloat(i.getAttribute("roughness"))})}return e.data=a,e}function q(t){const e={};return e.name=t.getAttribute("name"),e.displaycolor=t.getAttribute("displaycolor"),e.displaypropertiesid=t.getAttribute("displaypropertiesid"),e}function H(t){const e={},s=[],a=t.querySelectorAll("vertices vertex");for(let p=0;p<a.length;p++){const o=a[p],h=o.getAttribute("x"),m=o.getAttribute("y"),g=o.getAttribute("z");s.push(parseFloat(h),parseFloat(m),parseFloat(g))}e.vertices=new Float32Array(s);const l=[],i=[],u=t.querySelectorAll("triangles triangle");for(let p=0;p<u.length;p++){const o=u[p],h=o.getAttribute("v1"),m=o.getAttribute("v2"),g=o.getAttribute("v3"),O=o.getAttribute("p1"),F=o.getAttribute("p2"),C=o.getAttribute("p3"),A=o.getAttribute("pid"),b={};b.v1=parseInt(h,10),b.v2=parseInt(m,10),b.v3=parseInt(g,10),i.push(b.v1,b.v2,b.v3),O&&(b.p1=parseInt(O,10)),F&&(b.p2=parseInt(F,10)),C&&(b.p3=parseInt(C,10)),A&&(b.pid=A),0<Object.keys(b).length&&l.push(b)}return e.triangleProperties=l,e.triangles=new Uint32Array(i),e}function B(t){const e=[],s=t.querySelectorAll("component");for(let a=0;a<s.length;a++){const l=s[a],i=ee(l);e.push(i)}return e}function ee(t){const e={};e.objectId=t.getAttribute("objectid");const s=t.getAttribute("transform");return s&&(e.transform=E(s)),e}function E(t){const e=[];t.split(" ").forEach(function(a){e.push(parseFloat(a))});const s=new Ze;return s.set(e[0],e[3],e[6],e[9],e[1],e[4],e[7],e[10],e[2],e[5],e[8],e[11],0,0,0,1),s}function te(t){const e={type:t.getAttribute("type")},s=t.getAttribute("id");s&&(e.id=s);const a=t.getAttribute("pid");a&&(e.pid=a);const l=t.getAttribute("pindex");l&&(e.pindex=l);const i=t.getAttribute("thumbnail");i&&(e.thumbnail=i);const u=t.getAttribute("partnumber");u&&(e.partnumber=u);const p=t.getAttribute("name");p&&(e.name=p);const o=t.querySelector("mesh");o&&(e.mesh=H(o));const h=t.querySelector("components");return h&&(e.components=B(h)),e}function re(t){const e={};e.basematerials={};const s=t.querySelectorAll("basematerials");for(let o=0;o<s.length;o++){const h=s[o],m=k(h);e.basematerials[m.id]=m}e.texture2d={};const a=t.querySelectorAll("texture2d");for(let o=0;o<a.length;o++){const h=a[o],m=v(h);e.texture2d[m.id]=m}e.colorgroup={};const l=t.querySelectorAll("colorgroup");for(let o=0;o<l.length;o++){const h=l[o],m=D(h);e.colorgroup[m.id]=m}e.pbmetallicdisplayproperties={};const i=t.querySelectorAll("pbmetallicdisplayproperties");for(let o=0;o<i.length;o++){const h=i[o],m=j(h);e.pbmetallicdisplayproperties[m.id]=m}e.texture2dgroup={};const u=t.querySelectorAll("texture2dgroup");for(let o=0;o<u.length;o++){const h=u[o],m=x(h);e.texture2dgroup[m.id]=m}e.object={};const p=t.querySelectorAll("object");for(let o=0;o<p.length;o++){const h=p[o],m=te(h);e.object[m.id]=m}return e}function ne(t){const e=[],s=t.querySelectorAll("item");for(let a=0;a<s.length;a++){const l=s[a],i={objectId:l.getAttribute("objectid")},u=l.getAttribute("transform");u&&(i.transform=E(u)),e.push(i)}return e}function pe(t){const e={unit:t.getAttribute("unit")||"millimeter"},s=t.querySelectorAll("metadata");s&&(e.metadata=M(s));const a=t.querySelector("resources");a&&(e.resources=re(a));const l=t.querySelector("build");return l&&(e.build=ne(l)),e}function fe(t,e,s,a){const l=t.texid,u=s.resources.texture2d[l];if(u){const p=a[u.path],o=u.contenttype,h=new Blob([p],{type:o}),m=URL.createObjectURL(h),g=f.load(m,function(){URL.revokeObjectURL(m)});switch(g.colorSpace=De,u.tilestyleu){case"wrap":g.wrapS=xe;break;case"mirror":g.wrapS=Le;break;case"none":case"clamp":g.wrapS=qe;break;default:g.wrapS=xe}switch(u.tilestylev){case"wrap":g.wrapT=xe;break;case"mirror":g.wrapT=Le;break;case"none":case"clamp":g.wrapT=qe;break;default:g.wrapT=xe}switch(u.filter){case"auto":g.magFilter=we,g.minFilter=Ue;break;case"linear":g.magFilter=we,g.minFilter=we;break;case"nearest":g.magFilter=Be,g.minFilter=Be;break;default:g.magFilter=we,g.minFilter=Ue}return g}else return null}function J(t,e,s,a,l,i,u){const p=u.pindex,o={};for(let g=0,O=e.length;g<O;g++){const F=e[g],C=F.p1!==void 0?F.p1:p;o[C]===void 0&&(o[C]=[]),o[C].push(F)}const h=Object.keys(o),m=[];for(let g=0,O=h.length;g<O;g++){const F=h[g],C=o[F],A=t.basematerials[F],b=Q(A,a,l,i,u,z),w=new ve,T=[],R=s.vertices;for(let Y=0,ae=C.length;Y<ae;Y++){const P=C[Y];T.push(R[P.v1*3+0]),T.push(R[P.v1*3+1]),T.push(R[P.v1*3+2]),T.push(R[P.v2*3+0]),T.push(R[P.v2*3+1]),T.push(R[P.v2*3+2]),T.push(R[P.v3*3+0]),T.push(R[P.v3*3+1]),T.push(R[P.v3*3+2])}w.setAttribute("position",new le(T,3));const _=new ye(w,b);m.push(_)}return m}function oe(t,e,s,a,l,i,u){const p=new ve,o=[],h=[],m=s.vertices,g=t.uvs;for(let A=0,b=e.length;A<b;A++){const w=e[A];o.push(m[w.v1*3+0]),o.push(m[w.v1*3+1]),o.push(m[w.v1*3+2]),o.push(m[w.v2*3+0]),o.push(m[w.v2*3+1]),o.push(m[w.v2*3+2]),o.push(m[w.v3*3+0]),o.push(m[w.v3*3+1]),o.push(m[w.v3*3+2]),h.push(g[w.p1*2+0]),h.push(g[w.p1*2+1]),h.push(g[w.p2*2+0]),h.push(g[w.p2*2+1]),h.push(g[w.p3*2+0]),h.push(g[w.p3*2+1])}p.setAttribute("position",new le(o,3)),p.setAttribute("uv",new le(h,2));const O=Q(t,a,l,i,u,fe),F=new be({map:O,flatShading:!0});return new ye(p,F)}function N(t,e,s,a){const l=new ve,i=[],u=[],p=s.vertices,o=t.colors;for(let g=0,O=e.length;g<O;g++){const F=e[g],C=F.v1,A=F.v2,b=F.v3;i.push(p[C*3+0]),i.push(p[C*3+1]),i.push(p[C*3+2]),i.push(p[A*3+0]),i.push(p[A*3+1]),i.push(p[A*3+2]),i.push(p[b*3+0]),i.push(p[b*3+1]),i.push(p[b*3+2]);const w=F.p1!==void 0?F.p1:a.pindex,T=F.p2!==void 0?F.p2:w,R=F.p3!==void 0?F.p3:w;u.push(o[w*3+0]),u.push(o[w*3+1]),u.push(o[w*3+2]),u.push(o[T*3+0]),u.push(o[T*3+1]),u.push(o[T*3+2]),u.push(o[R*3+0]),u.push(o[R*3+1]),u.push(o[R*3+2])}l.setAttribute("position",new le(i,3)),l.setAttribute("color",new le(u,3));const h=new be({vertexColors:!0,flatShading:!0});return new ye(l,h)}function de(t){const e=new ve;e.setIndex(new Ie(t.triangles,1)),e.setAttribute("position",new Ie(t.vertices,3));const s=new be({name:Pe.DEFAULT_MATERIAL_NAME,color:16777215,flatShading:!0});return new ye(e,s)}function Ae(t,e,s,a,l,i){const u=Object.keys(t),p=[];for(let o=0,h=u.length;o<h;o++){const m=u[o],g=t[m];switch(Fe(m,a)){case"material":const F=a.resources.basematerials[m],C=J(F,g,e,s,a,l,i);for(let w=0,T=C.length;w<T;w++)p.push(C[w]);break;case"texture":const A=a.resources.texture2dgroup[m];p.push(oe(A,g,e,s,a,l,i));break;case"vertexColors":const b=a.resources.colorgroup[m];p.push(N(b,g,e,i));break;case"default":p.push(de(e));break;default:console.error("THREE.3MFLoader: Unsupported resource type.")}}if(i.name)for(let o=0;o<p.length;o++)p[o].name=i.name;return p}function Fe(t,e){return e.resources.texture2dgroup[t]!==void 0?"texture":e.resources.basematerials[t]!==void 0?"material":e.resources.colorgroup[t]!==void 0?"vertexColors":t==="default"?"default":void 0}function he(t,e){const s={},a=t.triangleProperties,l=e.pid;for(let i=0,u=a.length;i<u;i++){const p=a[i];let o=p.pid!==void 0?p.pid:l;o===void 0&&(o="default"),s[o]===void 0&&(s[o]=[]),s[o].push(p)}return s}function $(t,e,s,a,l){const i=new Me,u=he(t,l),p=Ae(u,t,e,s,a,l);for(let o=0,h=p.length;o<h;o++)i.add(p[o]);return i}function Z(t,e,s){if(!t)return;const a=[],l=Object.keys(t);for(let i=0;i<l.length;i++){const u=l[i];for(let p=0;p<c.availableExtensions.length;p++){const o=c.availableExtensions[p];o.ns===u&&a.push(o)}}for(let i=0;i<a.length;i++){const u=a[i];u.apply(s,t[u.ns],e)}}function Q(t,e,s,a,l,i){return t.build!==void 0||(t.build=i(t,e,s,a,l)),t.build}function z(t,e,s){let a;const l=t.displaypropertiesid,i=s.resources.pbmetallicdisplayproperties;if(l!==null&&i[l]!==void 0){const h=i[l].data[t.index];a=new _e({flatShading:!0,roughness:h.roughness,metalness:h.metallicness})}else a=new be({flatShading:!0});a.name=t.name;const u=t.displaycolor,p=u.substring(0,7);return a.color.setStyle(p,De),u.length===9&&(a.opacity=parseInt(u.charAt(7)+u.charAt(8),16)/255),a}function Se(t,e,s,a){const l=new Me;for(let i=0;i<t.length;i++){const u=t[i];let p=e[u.objectId];p===void 0&&(me(u.objectId,e,s,a),p=e[u.objectId]);const o=p.clone(),h=u.transform;h&&o.applyMatrix4(h),l.add(o)}return l}function me(t,e,s,a){const l=s.resources.object[t];if(l.mesh){const i=l.mesh,u=s.extensions,p=s.xml;Z(u,i,p),e[l.id]=Q(i,e,s,a,l,$)}else{const i=l.components;e[l.id]=Q(i,e,s,a,l,Se)}l.name&&(e[l.id].name=l.name)}function se(t){const e=t.model,s=t.modelRels,a={},l=Object.keys(e),i={};if(s)for(let u=0,p=s.length;u<p;u++){const o=s[u],h=o.target.substring(1);t.texture[h]&&(i[o.target]=t.texture[h])}for(let u=0;u<l.length;u++){const p=l[u],o=e[p],h=Object.keys(o.resources.object);for(let m=0;m<h.length;m++){const g=h[m];me(g,a,o,i)}}return a}function W(t){for(let e=0;e<t.length;e++){const s=t[e];if(s.target.split(".").pop().toLowerCase()==="model")return s}}function ge(t,e){const s=new Me,a=W(e.rels),l=e.model[a.target.substring(1)].build;for(let i=0;i<l.length;i++){const u=l[i],p=t[u.objectId].clone(),o=u.transform;o&&p.applyMatrix4(o),s.add(p)}return s}const X=d(n),ie=se(X);return ge(ie,X)}addExtension(n){this.availableExtensions.push(n)}}export{bt as ThreeMFLoader};
